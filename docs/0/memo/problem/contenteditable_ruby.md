# ルビ編集の問題

　HTMLの`contenteditable`属性を使ってルビを削除するとゴミタグが残ってしまう。

## ルビを削除すると`<ruby></ruby>`タグが残る

　キャレットはルビにまで及ぶ。HTMLの`contenteditable`属性をもった要素はクリックするとテキスト編集モードになる。カーソルキーでキャレットを操作できる。`<ruby>漢字<rt>かんじ</rt></ruby>`というルビ要素があったとき、フリガナの`かんじ`部分までキャレットが移動できる。文字の追加や削除ができる。

　ルビのフリガナを削除したときHTMLタグが残ってしまう。`<ruby>漢字<rt>かんじ</rt></ruby>`のとき、エディタで`かんじ`の部分を<kbd>BkSp</kbd>キーで削除する。もしすべてのフリガナを削除すると`<ruby>漢字</ruby>`となり、`<ruby>`タグが残ってしまう。

* `<rt>`が1文字以上残っている：`<ruby>漢字<rt>か</rt></ruby>`
* `<rt>`が1文字もない：`<ruby>漢字</ruby>`

　ルビを一度でも振ってしまうと、そのあとでフリガナを削除したとしても親元の`<ruby></ruby>`タグが残ってしまう。

### ルビが振れなくなる

　もう二度とこの部分にルビを振れなくなる。上記のように`<ruby>漢字</ruby>`の状態になってしまうと発生する。現在の実装では、選択したテキストの要素が`<ruby>`であれば入力させないようにしてあるため。

* ルビの範囲が広すぎた：もう二度と修正できない

